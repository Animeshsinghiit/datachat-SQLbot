
SQL Queries for Sample Questions
Sales Data Model
Units Sold

Q1: How many units were sold in the last 30 days

SELECT SUM(quantity) AS units_sold
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY);

Q2: How many units were sold this month

SELECT SUM(quantity) AS units_sold
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE()) 
AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())

Q3: How many units were sold this quarter

SELECT SUM(quantity) AS units_sold
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE()) 
AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())

Q4: How many units were sold this year

SELECT SUM(quantity) AS units_sold
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE()) 

Q5: How do the units sold this week compare to the same time last week
Q6: What is the percentage change in units sold this week compared to the same time last week

    WITH current_week AS
    (
        SELECT SUM(quantity) AS units_sold
        FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
        WHERE order_date BETWEEN DATE_TRUNC(CURRENT_DATE(), WEEK) AND CURRENT_DATE()
    ),

    last_week AS (
        SELECT SUM(quantity) AS units_sold
        FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
        WHERE order_date BETWEEN DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 1 WEEK), WEEK) AND DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 DAY)
    )

    SELECT
    current_week.units_sold AS units_sold_this_week,
    last_week.units_sold AS units_sold_last_week,
    (current_week.units_sold - last_week.units_sold) AS difference,
    ((current_week.units_sold - last_week.units_sold) / NULLIF(last_week.units_sold, 0)) * 100 AS percent_change
    FROM current_week, last_week

Q7: How do the units sold this week compare to the same time last month 
Q8: What is the percentage change in units sold this week compared to the same time last month 

WITH current_week AS
(
    SELECT  SUM(quantity) AS units_sold
    FROM  `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE order_date BETWEEN DATE_TRUNC(CURRENT_DATE(), WEEK) AND CURRENT_DATE()
),

last_month AS (
    SELECT SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE 
        order_date >= DATE_SUB(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL 1 MONTH) 
        AND order_date < DATE_TRUNC(CURRENT_DATE(), WEEK)
)

SELECT
    current_week.units_sold AS units_sold_this_week,
    last_month.units_sold AS units_sold_last_month,
    (current_week.units_sold - last_month.units_sold) AS difference,
    ((current_week.units_sold - last_month.units_sold) / NULLIF(last_month.units_sold, 0)) * 100 AS percent_change
FROM current_week, last_month


Q9: How do the units sold this week compare to the same time last year
Q10: What is the percentage change in units sold this week compared to the same time last year

WITH current_week AS
(
    SELECT SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date BETWEEN DATE_TRUNC(CURRENT_DATE(), WEEK) AND CURRENT_DATE()
),

last_year_same_week AS (
    SELECT SUM(quantity) AS units_sold
    FROM  `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE order_date BETWEEN DATE_ADD(DATE_TRUNC(CURRENT_DATE(), WEEK), INTERVAL -1 YEAR) AND DATE_ADD(CURRENT_DATE(), INTERVAL -1 YEAR)
)

SELECT
    current_week.units_sold AS units_sold_this_week,
    last_year_same_week.units_sold AS units_sold_last_year_same_week,
    (current_week.units_sold - last_year_same_week.units_sold) AS difference,
    ((current_week.units_sold - last_year_same_week.units_sold) / NULLIF(last_year_same_week.units_sold, 0)) * 100 AS percent_change
FROM current_week, last_year_same_week

Q11:  What is the trend in daily units sold this month

  SELECT order_date, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 1

Q12:  What is the trend in daily units sold this quarter

  SELECT order_date, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 1

Q12:  What is the trend in daily units sold this year

  SELECT order_date, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
     GROUP BY 1
    ORDER BY 1

Q13:  What is the breakdown of the units sold this week by channel

    SELECT sales_channel_name, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(WEEK FROM order_date) = EXTRACT(WEEK FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q14:  What is the breakdown of the units sold this month by channel

    SELECT sales_channel_name, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q15:  What is the breakdown of the units sold this quarter by channel

    SELECT sales_channel_name, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q16:  What is the breakdown of the units sold this year by channel

    SELECT sales_channel_name, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q17:  What is the breakdown of the units sold this week by brand 

    SELECT brand, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(WEEK FROM order_date) = EXTRACT(WEEK FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q18:  What is the breakdown of the units sold this month by brand

    SELECT brand, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q19:  What is the breakdown of the units sold this quarter by brand

    SELECT brand, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q20:  What is the breakdown of the units sold this year by brand

    SELECT brand, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q21:  What is the breakdown of the units sold this week by category 

    SELECT category, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(WEEK FROM order_date) = EXTRACT(WEEK FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q22:  What is the breakdown of the units sold this month by category

    SELECT category, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q23:  What is the breakdown of the units sold this quarter by category

    SELECT category, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q24:  What is the breakdown of the units sold this year by category

    SELECT category, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q25:  What is the breakdown of the units sold this week by sub-category 

    SELECT subcategory, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(WEEK FROM order_date) = EXTRACT(WEEK FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q26:  What is the breakdown of the units sold this month by sub-category

    SELECT subcategory, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q27:  What is the breakdown of the units sold this quarter by sub-category

    SELECT subcategory, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q28:  What is the breakdown of the units sold this year by sub-category

    SELECT subcategory, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q29:  What is the breakdown of the units sold this week by product 

    SELECT product, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(WEEK FROM order_date) = EXTRACT(WEEK FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q30:  What is the breakdown of the units sold this month by product

    SELECT product, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(MONTH FROM order_date) = EXTRACT(MONTH FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q31:  What is the breakdown of the units sold this quarter by product

    SELECT product, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    AND EXTRACT(QUARTER FROM order_date) = EXTRACT(QUARTER FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC

Q32:  What is the breakdown of the units sold this year by product

    SELECT product, SUM(quantity) AS units_sold
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE EXTRACT(YEAR FROM order_date) = EXTRACT(YEAR FROM CURRENT_DATE())
    GROUP BY 1
    ORDER BY 2 DESC











Sales

Q1: What were the total sales for the last 30 days

SELECT SUM(revenue) AS sales
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY);

Q2: How do this yesterday's sales compare to the same day last month
Q3: What is the percentage change in sales yesterday compared to the same day last month

WITH yesterday_sales AS (
    SELECT SUM(revenue) AS sales_yesterday
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date = DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)
),
same_day_last_month_sales AS (
    SELECT  SUM(revenue) AS sales_same_day_last_month
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date = DATE_SUB(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH), INTERVAL 1 DAY)
)

SELECT
    yesterday_sales.sales_yesterday AS sales_yesterday,
    same_day_last_month_sales.sales_same_day_last_month AS sales_same_day_last_month,
    (yesterday_sales.sales_yesterday - same_day_last_month_sales.sales_same_day_last_month) AS sales_difference,
    (yesterday_sales.sales_yesterday - same_day_last_month_sales.sales_same_day_last_month) / NULLIF(same_day_last_month_sales.sales_same_day_last_month, 0) * 100 AS percent_change
FROM 
    yesterday_sales, same_day_last_month_sales

Q4: How do this yesterday's sales compare to the same day last year
Q5: What is the percentage change in sales yesterday compared to the same day last year

WITH yesterday_sales AS (
    SELECT SUM(revenue) AS sales_yesterday
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE   order_date >= DATE_SUB(DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY), INTERVAL 1 YEAR)
    AND order_date < DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)
),
same_day_last_year_sales AS (
    SELECT SUM(revenue) AS sales_same_day_last_year
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_SUB(DATE_SUB(DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR), INTERVAL 1 DAY), INTERVAL 1 YEAR)
    AND  order_date < DATE_SUB(DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR), INTERVAL 1 DAY)
)
SELECT
    yesterday_sales.sales_yesterday AS sales_yesterday,
    same_day_last_year_sales.sales_same_day_last_year AS sales_same_day_last_year,
    (yesterday_sales.sales_yesterday - same_day_last_year_sales.sales_same_day_last_year) AS sales_difference,
    (yesterday_sales.sales_yesterday - same_day_last_year_sales.sales_same_day_last_year) / NULLIF(same_day_last_year_sales.sales_same_day_last_year, 0) * 100 AS percent_change
FROM 
    yesterday_sales, same_day_last_year_sales

Q6: How do this month's sales compare to the same time last month
Q7: What is the percentage change in sales this month compared to the same time last month

 WITH current_month AS
(
    SELECT  SUM(revenue) AS sales_this_month
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(CURRENT_DATE(), MONTH)
    AND order_date < DATE_ADD(DATE_TRUNC(CURRENT_DATE(), MONTH), INTERVAL 1 MONTH)
),

last_month AS (
    SELECT  SUM(revenue) AS sales_last_month
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH), MONTH)   
    AND order_date < DATE_TRUNC(CURRENT_DATE(), MONTH)  
)

SELECT
    current_month.sales_this_month AS sales_this_month,
    last_month.sales_last_month AS sales_last_month,
    (current_month.sales_this_month - last_month.sales_last_month) AS sales_difference,
    (current_month.sales_this_month - last_month.sales_last_month) / NULLIF(last_month.sales_last_month, 0) * 100 AS percent_change
FROM  current_month, last_month

Q8: How do this quarter's sales compare to the same time last quarter
Q9: What is the percentage change in sales this quarter compared to the same time last quarter

WITH current_quarter AS (
    SELECT  SUM(revenue) AS sales_this_quarter
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(CURRENT_DATE(), QUARTER)  
  AND order_date < DATE_ADD(DATE_TRUNC(CURRENT_DATE(), QUARTER), INTERVAL 3 MONTH) ),
last_quarter AS (
    SELECT  SUM(revenue) AS sales_last_quarter
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 1 QUARTER), QUARTER)          AND order_date < DATE_ADD(DATE_TRUNC(CURRENT_DATE(), QUARTER), INTERVAL 0 QUARTER) 
)

SELECT
    current_quarter.sales_this_quarter AS sales_this_quarter,
    last_quarter.sales_last_quarter AS sales_last_quarter,
    (current_quarter.sales_this_quarter - last_quarter.sales_last_quarter) AS sales_difference,
    (current_quarter.sales_this_quarter - last_quarter.sales_last_quarter) / NULLIF(last_quarter.sales_last_quarter, 0) * 100 AS percent_change
FROM current_quarter, last_quarter

Q10: How do this year's sales compare to the same time last year
Q11: What is the percentage change in sales this year compared to the same time last year

WITH current_year AS (
    SELECT  SUM(revenue) AS sales_this_year
    FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(CURRENT_DATE(), YEAR)
        AND order_date < DATE_ADD(DATE_TRUNC(CURRENT_DATE(), YEAR), INTERVAL 1 YEAR)
),
last_year AS (
    SELECT  SUM(revenue) AS sales_last_year
    FROM  `datachannel-238509.dt_sellerintelligence.sales_data_model`
    WHERE  order_date >= DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 1 YEAR), YEAR)
        AND order_date < DATE_TRUNC(CURRENT_DATE(), YEAR)
)

SELECT
    current_year.sales_this_year AS sales_this_year,
    last_year.sales_last_year AS sales_last_year,
    (current_year.sales_this_year - last_year.sales_last_year) AS sales_difference,
    (current_year.sales_this_year - last_year.sales_last_year) / NULLIF(last_year.sales_last_year, 0) * 100 AS percent_change
FROM  current_year, last_year

Orders

Q1: What is the total number of orders received yesterday

SELECT SUM(revenue) AS sales
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY);

Average Order Value

Q1: What were the total sales for the last 30 days

SELECT SUM(revenue) AS sales
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY);

—------ IGNORE BELOW —-------
Marketing Data Model
Spend

Q1: How many units were sold in the last 30 days

SELECT SUM(quantity) AS units_sold
FROM `datachannel-238509.dt_sellerintelligence.sales_data_model`
WHERE order_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY);
  2
 






